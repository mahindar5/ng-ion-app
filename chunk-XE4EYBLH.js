import{Q as dt,X as pt,ba as ut,c as it,d as nt,e as ot,f as lt,g as at,k as rt,o as ct,p as st,v as Te}from"./chunk-LJYLQJYK.js";import{a as O,h as $e,j as Be,l as D,m as T,o as qe}from"./chunk-OVPQ4WUL.js";import{C as q,D as Q,E as _e,F as ge,G as Re,H as Le,I as ze,J as ee,K as R,L as he,M as Ce,N as L,P as z,Q as He,R as Ge,V as Se,W as xe,Y as je,_ as Ke,a as Ne,aa as fe,ba as ye,c as me,ca as te,da as ve,ea as Ue,ga as Ye,ia as H,ja as N,ka as G,m as J,ma as Je,na as Ze,p as Z,qa as Xe,ra as j,sa as be,t as X,ta as et,ua as Pe,va as Me,xa as tt}from"./chunk-G2P7PRAA.js";import{$a as _,Aa as o,Ab as Ve,Bb as I,Cb as d,Db as f,Eb as v,Fb as ae,Gb as U,Hb as re,Ib as ce,Ja as V,Jb as se,Na as Ae,Ob as de,Qb as pe,Rb as Y,Sb as ue,Ub as b,Wb as P,_ as E,_a as m,ab as K,ac as w,bb as A,bc as $,cb as k,da as h,db as F,ea as C,eb as y,ec as B,fb as l,fc as Oe,gb as a,gc as Qe,hb as x,ka as S,l as We,nb as M,qb as u,rb as c,xb as De,ya as le,yb as Ee}from"./chunk-XQIDMOZH.js";import"./chunk-UWWRSBJN.js";import{a as we}from"./chunk-PE2J6P5Y.js";import"./chunk-LHBIE3WG.js";import"./chunk-M7HIEP6N.js";import"./chunk-3VHKZABS.js";import"./chunk-BIEIEMQH.js";import"./chunk-CASY3UTO.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-2YSZFPCQ.js";import"./chunk-57YRIO75.js";import"./chunk-JR2FMVVP.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{a as ne,b as oe}from"./chunk-3GJFFWBB.js";var ht=(i,s)=>[1,i,7,s],Ct=()=>[1,5,7];function St(i,s){if(i&1&&(l(0,"ion-select-option",13),d(1),a()),i&2){let e=s.$implicit;y("value",e.prop),o(),f(e.title)}}function xt(i,s){if(i&1){let e=M();l(0,"ion-button",18),u("click",function(){let n=h(e).$implicit,r=c();return C(r.adjustQuantity(n))}),d(1),a()}if(i&2){let e=s.$implicit;o(),ae(" ",e>0?"+":"","",e)}}function ft(i,s){if(i&1){let e=M();l(0,"ion-button",18),u("click",function(){let n=h(e).$implicit,r=c();return C(r.setQuantity(n))}),d(1),a()}if(i&2){let e=s.$implicit;o(),v(" ",e)}}function yt(i,s){if(i&1){let e=M();l(0,"span",22)(1,"span",23),u("click",function(){let n=h(e),r=n.$implicit,p=n.$index,g=c(3);return C(g.setItemPrice(p,r.limit_price))}),d(2),a(),x(3,"ion-icon",24),l(4,"span",23),u("click",function(){let n=h(e),r=n.$implicit,p=n.$index,g=c(3);return C(g.updateItemQuantity(p,r.quantity))}),d(5),a(),x(6,"ion-icon",25),l(7,"span"),d(8),b(9,"number"),a(),l(10,"ion-icon",26),u("click",function(){let n=h(e).$implicit,r=c(3);return C(r.deleteConfirm(n))}),a()()}if(i&2){let e=s.$implicit,t=c(2).$implicit;y("ngClass",e.time_in_force),o(2),f(e.limit_price),o(3),f(e.quantity),o(3),f(P(9,4,(t.position.totalPurchased+e.quantity*e.limit_price)/(t.position.quantity+e.quantity),"1.0-2"))}}function vt(i,s){if(i&1&&(l(0,"span"),k(1,yt,11,7,"span",22,A),a()),i&2){let e=c().$implicit;o(),F(e.position.pending)}}function bt(i,s){if(i&1){let e=M();l(0,"span",22)(1,"span",23),u("click",function(){let n=h(e),r=n.$implicit,p=n.$index,g=c(3);return C(g.setItemPrice(p,r.limit_price))}),d(2),a(),x(3,"ion-icon",24),l(4,"span",23),u("click",function(){let n=h(e),r=n.$implicit,p=n.$index,g=c(3);return C(g.updateItemQuantity(p,r.quantity))}),d(5),a(),x(6,"ion-icon",25),l(7,"span"),d(8),b(9,"number"),a(),l(10,"ion-icon",26),u("click",function(){let n=h(e).$implicit,r=c(3);return C(r.deleteConfirm(n))}),a()()}if(i&2){let e=s.$implicit,t=c(2).$implicit;y("ngClass",e.time_in_force),o(2),f(e.limit_price),o(3),f(e.quantity),o(3),f(P(9,4,(t.position.totalPurchased-e.quantity*e.limit_price)/(t.position.quantity-e.quantity),"1.0-2"))}}function Pt(i,s){if(i&1&&(l(0,"span"),k(1,bt,11,7,"span",22,A),a()),i&2){let e=c().$implicit;o(),F(e.position.pendingSell)}}function Mt(i,s){if(i&1&&(l(0,"span"),d(1),b(2,"number"),a()),i&2){let e=c(4).$implicit;o(),f(P(2,1,(e.position.totalPurchased+e.quantity*e.price)/(e.position.quantity+e.quantity),"1.0-2"))}}function wt(i,s){if(i&1&&(l(0,"span"),d(1),b(2,"number"),a()),i&2){let e=c(4).$implicit;o(),f(P(2,1,(e.position.totalPurchased-e.quantity*e.price)/(e.position.quantity-e.quantity),"1.0-2"))}}function Tt(i,s){if(i&1&&(x(0,"ion-icon",25),m(1,Mt,3,4,"span"),m(2,wt,3,4,"span")),i&2){let e=c(4);o(),_(e.orderType()==="buy_quantity"?1:-1),o(),_(e.orderType()==="sell_quantity"?2:-1)}}function It(i,s){if(i&1){let e=M();l(0,"ion-col",27),d(1),a(),l(2,"ion-col",28)(3,"ion-icon",29),u("click",function(){h(e);let n=c(),r=n.$implicit,p=n.$index,g=c().$implicit,W=c();return C(W.setItemPrice(p,g.position[r.prop]))}),a(),d(4),l(5,"span",30),d(6),b(7,"number"),a(),m(8,Tt,3,2),a()}if(i&2){let e=c().$implicit,t=c().$implicit;o(),f(e.title),o(3),v(" ",t.position[e.prop]," "),o(2),v("(",P(7,4,(t.price/t.position[e.prop]-1)*100,"1.0-2"),"%)"),o(2),_(e.prop==="averagePrice"?8:-1)}}function kt(i,s){if(i&1&&m(0,It,9,7),i&2){let e=s.$implicit,t=c().$implicit,n=c();_(t.position[e.prop]&&(!e.orderType||e.orderType===n.orderType())?0:-1)}}function Ft(i,s){if(i&1){let e=M();l(0,"ion-item-divider")(1,"div",19)(2,"span")(3,"a",20),d(4),a(),l(5,"small"),d(6),a()(),m(7,vt,3,0,"span"),m(8,Pt,3,0,"span"),l(9,"span"),d(10),b(11,"number"),a()()(),l(12,"ion-row")(13,"ion-col",8)(14,"ion-item")(15,"ion-input",10),u("ngModelChange",function(n){let r=h(e).$index,p=c();return C(p.updateItemQuantity(r,n))}),a()()(),l(16,"ion-col",8)(17,"ion-item")(18,"ion-input",21),u("ngModelChange",function(n){let r=h(e).$index,p=c();return C(p.updateItemPrice(r,n))}),a()()()(),l(19,"ion-row"),k(20,kt,1,1,null,null,A),a()}if(i&2){let e=s.$implicit,t=c();o(3),y("href",de("https://finance.yahoo.com/quote/",e.position.yahooStockSymbol),le),o(),f(e.position.stockSymbol),o(2),v("(",e.position.currency,")"),o(),_(t.orderType()==="buy_quantity"?7:-1),o(),_(t.orderType()==="sell_quantity"?8:-1),o(2),U("Qty: ",e.position.quantity,", Total: ",e.position.totalPurchased,", Order Amt: ",P(11,11,e.quantity*e.price,"1.0-2")),o(5),y("ngModel",e.quantity),o(3),y("ngModel",e.price),o(2),F(t.summaryList)}}var mt=()=>[];function Wt(i,s){i&1&&x(0,"ion-icon",10)}function At(i,s){if(i&1){let e=M();l(0,"ion-chip",9),u("click",function(){let n=h(e).$implicit,r=c(3);return C(r.setSearchField(n))})("dblclick",function(){let n=h(e).$implicit,r=c(3);return C(r.toggleGroupByField(n))}),l(1,"ion-label"),d(2),a(),m(3,Wt,1,0,"ion-icon",10),a()}if(i&2){let e=s.$implicit,t=c(3);I("active",t.isFieldSelected(e)),o(2),f(e),o(),_(t.groupByFieldValue()===e&&t.isGroupedValue()?3:-1)}}function Dt(i,s){if(i&1&&(l(0,"ion-item")(1,"ion-note"),d(2," Double-click a field to group/ungroup. Currently grouped by: "),l(3,"strong"),d(4),a()()()),i&2){let e=c(3);o(4),f(e.groupByFieldValue())}}function Et(i,s){if(i&1&&x(0,"ion-icon",15),i&2){let e=c(4);y("name",e.getSortIcon("assetSymbol"))}}function Vt(i,s){if(i&1&&x(0,"ion-icon",15),i&2){let e=c(4);y("name",e.getSortIcon("amount"))}}function Ot(i,s){if(i&1&&x(0,"ion-icon",15),i&2){let e=c(4);y("name",e.getSortIcon("accountId"))}}function Qt(i,s){if(i&1&&x(0,"ion-icon",15),i&2){let e=c(4);y("name",e.getSortIcon("frequency"))}}function Nt(i,s){if(i&1&&(l(0,"ion-item")(1,"ion-grid",12)(2,"ion-row")(3,"ion-col",16),d(4),a(),l(5,"ion-col",16),d(6),a(),l(7,"ion-col",16),d(8),a(),l(9,"ion-col",16),d(10),a()()()()),i&2){let e=s.$implicit,t=c(4);o(4),f(e.assetSymbol),o(2),f(e.amount?t.getFormattedAmount(e):"-"),o(2),f(e.accountId),o(2),f(e.frequency||"-")}}function $t(i,s){if(i&1){let e=M();l(0,"ion-card")(1,"ion-item",11)(2,"ion-grid",12)(3,"ion-row",13)(4,"ion-col",14),u("click",function(){h(e);let n=c(3);return C(n.sort("assetSymbol"))}),d(5," Symbol "),m(6,Et,1,1,"ion-icon",15),a(),l(7,"ion-col",14),u("click",function(){h(e);let n=c(3);return C(n.sort("amount"))}),d(8),m(9,Vt,1,1,"ion-icon",15),a(),l(10,"ion-col",14),u("click",function(){h(e);let n=c(3);return C(n.sort("accountId"))}),d(11," AccountId "),m(12,Ot,1,1,"ion-icon",15),a(),l(13,"ion-col",14),u("click",function(){h(e);let n=c(3);return C(n.sort("frequency"))}),d(14," Frequency "),m(15,Qt,1,1,"ion-icon",15),a()()()(),l(16,"ion-list"),k(17,Nt,11,4,"ion-item",null,A),a()()}if(i&2){let e=c(3);o(6),_(e.getSortIcon("assetSymbol")?6:-1),o(2),v(" Amount (",e.calculateTotalAmount(e.filteredActivities()),") "),o(),_(e.getSortIcon("amount")?9:-1),o(3),_(e.getSortIcon("accountId")?12:-1),o(3),_(e.getSortIcon("frequency")?15:-1),o(2),F(e.sortedActivities())}}function Bt(i,s){if(i&1&&x(0,"ion-icon",15),i&2){let e=c(6);y("name",e.getSortIcon("assetSymbol"))}}function qt(i,s){if(i&1&&x(0,"ion-icon",15),i&2){let e=c(6);y("name",e.getSortIcon("amount"))}}function Rt(i,s){if(i&1&&x(0,"ion-icon",15),i&2){let e=c(6);y("name",e.getSortIcon("accountId"))}}function Lt(i,s){if(i&1&&x(0,"ion-icon",15),i&2){let e=c(6);y("name",e.getSortIcon("frequency"))}}function zt(i,s){if(i&1&&(l(0,"ion-item")(1,"ion-grid",12)(2,"ion-row")(3,"ion-col",16),d(4),a(),l(5,"ion-col",16),d(6),a(),l(7,"ion-col",16),d(8),a(),l(9,"ion-col",16),d(10),a()()()()),i&2){let e=s.$implicit,t=c(6);o(4),f(e.assetSymbol),o(2),f(e.amount?t.getFormattedAmount(e):"-"),o(2),f(e.accountId),o(2),f(e.frequency||"-")}}function Ht(i,s){if(i&1){let e=M();l(0,"ion-card")(1,"ion-card-header")(2,"ion-card-subtitle"),d(3),a()(),l(4,"ion-item",11)(5,"ion-grid",12)(6,"ion-row",13)(7,"ion-col",14),u("click",function(){h(e);let n=c(5);return C(n.sort("assetSymbol"))}),d(8," Symbol "),m(9,Bt,1,1,"ion-icon",15),a(),l(10,"ion-col",14),u("click",function(){h(e);let n=c(5);return C(n.sort("amount"))}),d(11),m(12,qt,1,1,"ion-icon",15),a(),l(13,"ion-col",14),u("click",function(){h(e);let n=c(5);return C(n.sort("accountId"))}),d(14," AccountId "),m(15,Rt,1,1,"ion-icon",15),a(),l(16,"ion-col",14),u("click",function(){h(e);let n=c(5);return C(n.sort("frequency"))}),d(17," Frequency "),m(18,Lt,1,1,"ion-icon",15),a()()()(),l(19,"ion-list"),k(20,zt,11,4,"ion-item",null,A),a()()}if(i&2){let e=s.$implicit,t=c(5);o(3),ae("",t.groupByFieldValue(),": ",e),o(6),_(t.getSortIcon("assetSymbol")?9:-1),o(2),v(" Amount (",t.calculateTotalAmount(t.groupedData().get(e)||Y(7,mt)),") "),o(),_(t.getSortIcon("amount")?12:-1),o(3),_(t.getSortIcon("accountId")?15:-1),o(3),_(t.getSortIcon("frequency")?18:-1),o(2),F(t.groupedData().get(e)||Y(8,mt))}}function Gt(i,s){if(i&1&&(k(0,Ht,22,9,"ion-card",null,A),l(2,"ion-item",17)(3,"ion-label",18)(4,"strong"),d(5),a()()()),i&2){let e=c(4);F(e.groupKeys()),o(5),v("Overall Total: ",e.calculateTotalAmount(e.filteredActivities()))}}function jt(i,s){if(i&1&&m(0,Gt,6,1),i&2){let e=c(3);_(e.groupByFieldValue()&&e.groupedData().size>0?0:-1)}}function Kt(i,s){if(i&1){let e=M();l(0,"ion-item",4)(1,"ion-searchbar",5),u("ngModelChange",function(n){h(e);let r=c(2);return C(r.updateSearchTerm(n))}),a()(),l(2,"ion-list",4)(3,"ion-item")(4,"ion-label",6),d(5,"Search by:"),a()(),l(6,"ion-item")(7,"div",7)(8,"ion-chip",1),u("click",function(){h(e);let n=c(2);return C(n.setSearchField("all"))}),l(9,"ion-label"),d(10,"All"),a()(),k(11,At,4,4,"ion-chip",8,A),a()(),m(13,Dt,5,1,"ion-item"),a(),m(14,$t,19,5,"ion-card")(15,jt,1,1)}if(i&2){let e=c(2);o(),y("ngModel",e.searchTermValue()),o(7),I("active",e.isFieldSelected("all")),o(3),F(e.searchableFieldsValue().split(",")),o(2),_(e.groupByFieldValue()?13:-1),o(),_(e.isGroupedValue()?15:14)}}function Ut(i,s){i&1&&(l(0,"ion-card")(1,"ion-card-content",19),d(2," No scheduled activities found "),a()())}function Yt(i,s){if(i&1&&(l(0,"div"),m(1,Kt,16,5)(2,Ut,3,0,"ion-card"),a()),i&2){let e=c();o(),_(e.scheduledActivitiesValue().length>0?1:2)}}function Jt(i,s){i&1&&(x(0,"ion-spinner",20),l(1,"ion-text",19)(2,"p"),d(3,"Loading activities..."),a()())}var Zt=(i,s)=>({lower:i,upper:s}),Xt=(i,s)=>s.id;function ei(i,s){if(i&1&&(l(0,"span",0)(1,"span",2),d(2," T: "),l(3,"span",3)(4,"span",4),d(5),b(6,"number"),a(),l(7,"span"),d(8),b(9,"number"),a()()(),l(10,"span",2),d(11," C: "),l(12,"span",3)(13,"span",4),d(14),b(15,"number"),a(),l(16,"span"),d(17),b(18,"number"),a()()(),l(19,"span",2)(20,"span",3)(21,"span",4),d(22),b(23,"number"),a(),l(24,"span"),d(25),b(26,"number"),a()()(),l(27,"span",2),d(28," DC: "),l(29,"span",3)(30,"span",4),d(31),b(32,"number"),a(),l(33,"span"),d(34),b(35,"number"),a()()(),l(36,"span",2)(37,"span",3)(38,"span",4),d(39),b(40,"number"),a(),l(41,"span"),d(42),b(43,"number"),a()()()()),i&2){let e=s;o(5),f(P(6,42,e.totalValue,"1.0-2")),o(3),f(P(9,45,e.totalWS,"1.0-2")),o(5),I("lossStyles",e.changeAmount<0)("gainStyles",e.changeAmount>=0),o(),v(" ",P(15,48,e.changeAmount,"1.0-2")," "),o(2),I("lossStyles",e.changeAmountWS<0)("gainStyles",e.changeAmountWS>=0),o(),v(" ",P(18,51,e.changeAmountWS,"1.0-2")," "),o(4),I("lossStyles",e.changePercent<0)("gainStyles",e.changePercent>=0),o(),v(" ",P(23,54,e.changePercent,"1.0-2"),"% "),o(2),I("lossStyles",e.changePercentWS<0)("gainStyles",e.changePercentWS>=0),o(),v(" ",P(26,57,e.changePercentWS,"1.0-2"),"% "),o(5),I("lossStyles",e.todaysReturn<0)("gainStyles",e.todaysReturn>=0),o(),v(" ",P(32,60,e.todaysReturn,"1.0-2")," "),o(2),I("lossStyles",e.todaysReturnWS<0)("gainStyles",e.todaysReturnWS>=0),o(),v(" ",P(35,63,e.todaysReturnWS,"1.0-2")," "),o(4),I("lossStyles",e.todaysReturnPercent<0)("gainStyles",e.todaysReturnPercent>=0),o(),v(" ",P(40,66,e.todaysReturnPercent,"1.0-2"),"% "),o(2),I("lossStyles",e.todaysReturnPercentWS<0)("gainStyles",e.todaysReturnPercentWS>=0),o(),v(" ",P(43,69,e.todaysReturnPercentWS,"1.0-2"),"% ")}}function ti(i,s){if(i&1){let e=M();l(0,"ion-card-content")(1,"ion-toolbar")(2,"ion-button",5),u("click",function(){h(e);let n=c();return C(n.login())}),d(3,"Login"),a()()()}}function ii(i,s){if(i&1&&(l(0,"ion-select-option",10),d(1),a()),i&2){let e=s.$implicit;y("value",e),o(),U(" ",e.account_type," (",e.buying_power.amount," of ",e.net_deposits.amount,") ")}}function ni(i,s){if(i&1&&x(0,"ion-icon",17),i&2){let e=c(3);y("name",e.reverse()?"arrow-up-outline":"arrow-down-outline")}}function oi(i,s){if(i&1&&(l(0,"div",18),d(1),a()),i&2){let e=c().$implicit;o(),f(e.subTitle)}}function li(i,s){if(i&1){let e=M();l(0,"th",14),u("click",function(){let n=h(e).$implicit,r=c(2);return C(r.sort(n,r.sortField()==n.prop&&!r.reverse()))}),l(1,"div",15),d(2),a(),l(3,"div",16),m(4,ni,1,1,"ion-icon",17),a(),m(5,oi,2,1,"div",18),a()}if(i&2){let e=s.$implicit,t=c(2);Ve("min-width",e.width),o(2),f(e.title),o(2),_(t.sortField()==e.prop&&!e.disabled?4:-1),o(),_(e.subTitle?5:-1)}}function ai(i,s){i&1&&(l(0,"small"),d(1,"%"),a())}function ri(i,s){if(i&1&&(l(0,"span",23),d(1),b(2,"number"),a()),i&2){let e=c(2).$implicit,t=c().$implicit;I("lossStyles",t[e.prop]>t.regularMarketChange)("gainStyles",t[e.prop]<t.regularMarketChange),o(),v(" ",P(2,5,t.regularMarketChange/t[e.prop]*100,"1.0-2"),"% ")}}function ci(i,s){if(i&1&&(l(0,"span",23),d(1),b(2,"number"),a()),i&2){let e=c(2).$implicit,t=c().$implicit;I("lossStyles",t[e.prop]>t.regularMarketPrice)("gainStyles",t[e.prop]<t.regularMarketPrice),o(),v(" ",P(2,5,(t.regularMarketPrice/t[e.prop]-1)*100,"1.0-2"),"% ")}}function si(i,s){if(i&1&&(l(0,"td")(1,"table")(2,"tbody")(3,"tr")(4,"td",21)(5,"span"),d(6),m(7,ai,2,0,"small"),a()(),l(8,"td"),m(9,ri,3,8,"span",22),a()(),l(10,"tr")(11,"td"),m(12,ci,3,8,"span",22),a()()()()()),i&2){let e=c().$implicit,t=c().$implicit;I("bold",e.bold),o(5),I("lossStyles",e.highlightCell&&t[e.prop]<(e.medianNumber||0))("gainStyles",e.highlightCell&&t[e.prop]>=(e.medianNumber||0)),o(),v(" ",t[e.prop]," "),o(),_(e.subTitle=="percent"&&t[e.prop]!==null?7:-1),o(2),_(e.percent&&t[e.prop]?9:-1),o(3),_(e.percent&&t[e.prop]?12:-1)}}function di(i,s){if(i&1){let e=M();l(0,"ion-checkbox",28),se("ngModelChange",function(n){h(e);let r=c(4).$implicit;return ce(r.selected,n)||(r.selected=n),C(n)}),a()}if(i&2){let e=c(4).$implicit;re("ngModel",e.selected)}}function pi(i,s){if(i&1&&(l(0,"small"),d(1),a()),i&2){let e=c(4).$implicit;o(),f(e==null||e.pending==null?null:e.pending.length)}}function ui(i,s){if(i&1&&(l(0,"small"),d(1),a()),i&2){let e=c(4).$implicit;o(),v(", ",e==null||e.pendingSell==null?null:e.pendingSell.length)}}function mi(i,s){if(i&1){let e=M();l(0,"td",26),u("click",function(){h(e);let n=c(3).$implicit,r=c(2);return C(r.openAdditionOperationsAlert(n))}),m(1,di,1,1,"ion-checkbox",27),l(2,"ion-label"),d(3),m(4,pi,2,1,"small"),m(5,ui,2,1,"small"),a()()}if(i&2){let e=c(3).$implicit,t=c(2);o(),_(t.multiSelectMode()?1:-1),o(2),v(" ",e.stockSymbol," "),o(),_(!(e==null||e.pending==null)&&e.pending.length?4:-1),o(),_(!(e==null||e.pendingSell==null)&&e.pendingSell.length?5:-1)}}function _i(i,s){if(i&1&&(l(0,"ion-range",29)(1,"ion-label",30),d(2),a(),l(3,"ion-label",31),d(4),a()()),i&2){let e=c(4).$implicit;y("min",e.regularMarketDayLow)("max",e.regularMarketDayHigh)("value",e.regularMarketPrice),o(2),f(e.regularMarketDayLow),o(2),f(e.regularMarketDayHigh)}}function gi(i,s){if(i&1&&(l(0,"td"),m(1,_i,5,5,"ion-range",29),a()),i&2){let e=c(3).$implicit;o(),_(e.regularMarketDayLow?1:-1)}}function hi(i,s){if(i&1&&(l(0,"ion-range",32)(1,"ion-label",30),d(2),a(),l(3,"ion-label",31),d(4),a()()),i&2){let e=c(4).$implicit;y("step",(e.fiftyTwoWeekHigh-e.fiftyTwoWeekLow)/5)("min",e.fiftyTwoWeekLow)("max",e.fiftyTwoWeekHigh)("value",ue(6,Zt,e.regularMarketDayLow,e.regularMarketPrice)),o(2),f(e.fiftyTwoWeekLow),o(2),f(e.fiftyTwoWeekHigh)}}function Ci(i,s){if(i&1&&(l(0,"td"),m(1,hi,5,9,"ion-range",32),a()),i&2){let e=c(3).$implicit;o(),_(e.fiftyTwoWeekHigh?1:-1)}}function Si(i,s){if(i&1&&(l(0,"td",25)(1,"a",33),d(2),a()()),i&2){let e=c(3).$implicit;o(),y("href",de("https://finance.yahoo.com/quote/",e.yahooStockSymbol),le),o(),f(e.stockName)}}function xi(i,s){if(i&1&&m(0,mi,6,4,"td",24)(1,gi,2,1,"td")(2,Ci,2,1,"td")(3,Si,3,3,"td",25),i&2){let e,t=c().$implicit;_((e=t.templatedId)==="stockSymbol"?0:e==="dayRange"?1:e==="52WRange"?2:e==="stockName"?3:-1)}}function fi(i,s){if(i&1&&(m(0,si,13,10,"td",20),m(1,xi,4,1)),i&2){let e=s.$implicit;_(e.templatedId?-1:0),o(),_(e.templatedId?1:-1)}}function yi(i,s){if(i&1){let e=M();l(0,"tr",19),u("click",function(){let n=h(e).$index,r=c(2);return C(r.selectedIndex.set(n))}),k(1,fi,2,2,null,null,K),a()}if(i&2){let e=s.$index,t=c(2);I("selected",t.selectedIndex()===e),o(),F(t.headers)}}function vi(i,s){if(i&1){let e=M();l(0,"ion-card-content")(1,"ion-refresher",6),u("ionRefresh",function(n){h(e);let r=c();return C(r.getPositions(n))}),x(2,"ion-refresher-content"),a(),l(3,"div",7)(4,"ion-searchbar",8),u("ngModelChange",function(n){h(e);let r=c();return C(r.searchBy.set(n))}),a(),l(5,"ion-item")(6,"ion-select",9),u("ngModelChange",function(n){h(e);let r=c();return r.selectedAccount.set(n),C(r.getPositions(void 0))}),k(7,ii,2,4,"ion-select-option",10,A),a()()(),l(9,"table",11)(10,"thead")(11,"tr"),k(12,li,6,5,"th",12,K),a()(),l(14,"tbody"),k(15,yi,3,2,"tr",13,Xt),a()()()}if(i&2){let e=c();I("multiselectmode",e.multiSelectMode()),o(4),y("ngModel",e.searchBy()),o(2),y("ngModel",e.selectedAccount()),o(),F(e.accounts()),o(5),F(e.headers),o(3),F(e.filteredPositions())}}function bi(i,s){if(i&1){let e=M();l(0,"ion-button",35),u("click",function(){h(e);let n=c(2);return C(n.getPositions(void 0))}),x(1,"ion-icon",39),a()}}function Pi(i,s){if(i&1){let e=M();l(0,"ion-button",35),u("click",function(){h(e);let n=c(2);return C(n.openAdditionOperationsAlert())}),x(1,"ion-icon",40),a(),l(2,"ion-button",35),u("click",function(){h(e);let n=c(2);return C(n.toggleMultiSelect(!1))}),x(3,"ion-icon",41),a(),l(4,"ion-button",35),u("click",function(){h(e);let n=c(2);return C(n.selectAll())}),x(5,"ion-icon",42),a()}}function Mi(i,s){if(i&1){let e=M();l(0,"ion-button",35),u("click",function(){h(e);let n=c(2);return C(n.toggleMultiSelect(!0))}),x(1,"ion-icon",43),a()}}function wi(i,s){if(i&1){let e=M();l(0,"ion-footer")(1,"ion-toolbar")(2,"ion-buttons",7),m(3,bi,2,0,"ion-button",34),m(4,Pi,6,0),m(5,Mi,2,0,"ion-button",34),l(6,"ion-button",35),u("click",function(){h(e);let n=c();return C(n.logout())}),x(7,"ion-icon",36),a(),l(8,"ion-button",37),u("click",function(){h(e);let n=c();return C(n.openScheduledActivitiesModal())}),x(9,"ion-icon",38),a()()()()}if(i&2){let e=c();o(3),_(e.positions()?3:-1),o(),_(e.multiSelectMode()?4:-1),o(),_(e.multiSelectMode()?-1:5)}}var Ti="YahooCrumbKey",Ii=5,ki=(()=>{class i{wealthSimpleService=O(D);viewCtrl=E(G);accountId=B();orderType=B();positions=B();amount=S(50);quantity=S(7);pricePercentage=S(100-Ii);priceType=S("averagePrice");untilCancelled=Qe(!0);buyingPower=S(0);pollingId=S(void 0);itemOverrides=S(new Map);global=w(()=>({pricePercentage:this.pricePercentage(),quantity:this.quantity(),priceType:this.priceType(),untilCancelled:this.untilCancelled(),amount:this.amount()}));data=w(()=>{let e=this.positions()||[],t=this.global(),n=this.itemOverrides();return e.map((r,p)=>{let g=r[t.priceType]||r.regularMarketPrice,W=parseFloat((t.pricePercentage*g/100).toFixed(2)),ie=Math.ceil((this.orderType()===T.SellQuantity?r.returnPercent:t.amount)/W),Fe=n.get(p),_t=Fe?.price??W,gt=Fe?.quantity??ie;return{price:_t,quantity:gt,untilCancelled:t.untilCancelled,position:r}})});total=w(()=>this.data().reduce((e,t)=>e+t.price*t.quantity,0));summaryList=[{prop:"regularMarketPrice",title:"Current"},{prop:"regularMarketDayLow",title:"Day Low",orderType:T.BuyQuantity},{prop:"regularMarketDayHigh",title:"Day High",orderType:T.SellQuantity},{prop:"averagePrice",title:"Average"},{prop:"min",title:"Min Buy",orderType:T.BuyQuantity},{prop:"lastPurchasePrice",title:"Prev Order",orderType:T.BuyQuantity},{prop:"fiftyTwoWeekLow",title:"52 Week Low",orderType:T.BuyQuantity},{prop:"lastPendingPurchasePrice",title:"Last Pending",orderType:T.BuyQuantity},{prop:"minPendingPurchasePrice",title:"Min Pending",orderType:T.BuyQuantity},{prop:"maxSell",title:"Max Sell",orderType:T.SellQuantity},{prop:"lastPurchasePriceSell",title:"Prev Order Sell",orderType:T.SellQuantity},{prop:"fiftyTwoWeekHigh",title:"52 Week High",orderType:T.SellQuantity},{prop:"lastPendingPurchasePriceSell",title:"Last Pending Sell",orderType:T.SellQuantity},{prop:"maxPendingPurchasePriceSell",title:"Max Pending Sell",orderType:T.SellQuantity},{prop:"regularMarketOpen",title:"Open"},{prop:"regularMarketPreviousClose",title:"Prev Close"}];constructor(){$(()=>{this.orderType()===T.SellQuantity&&(this.pricePercentage.set(100),this.priceType.set("regularMarketPrice"))}),$(()=>{if(this.pollingId()){let t=window.setInterval(()=>this.performFullFlow(),5e3);this.pollingId.set(t)}})}ngOnInit(){this.init()}ngOnDestroy(){this.stopPolling()}updateAmount(e){this.amount.set(e)}updateQuantity(e){this.quantity.set(e)}updatePricePercentage(e){this.pricePercentage.set(e)}updatePriceType(e){this.priceType.set(e)}adjustQuantity(e){this.quantity.update(t=>t+e)}setQuantity(e){this.quantity.set(e)}updateItemQuantity(e,t){this.itemOverrides.update(n=>{let r=new Map(n),p=r.get(e)||{};return r.set(e,oe(ne({},p),{quantity:t})),r})}updateItemPrice(e,t){this.itemOverrides.update(n=>{let r=new Map(n),p=r.get(e)||{};return r.set(e,oe(ne({},p),{price:t})),r})}setItemPrice(e,t){this.updateItemPrice(e,t)}startPolling(){this.stopPolling(),this.performFullFlow();let e=window.setInterval(()=>this.performFullFlow(),5e3);this.pollingId.set(e)}dismissModal(){this.viewCtrl.dismiss()}stopPolling(){let e=this.pollingId();e&&(clearInterval(e),this.pollingId.set(void 0))}async performFullFlow(){let e=this.positions();if(!e?.length)return;let t=await this.wealthSimpleService.getYahooQuotes(e.map(n=>n.yahooStockSymbol));this.mapPositions(t)}mapPositions(e){if(e?.status===401)throw $e.removeItem(Ti),new Error("Yahoo Finance Unauthorized Error");let t=this.positions();if(!t)return;let n=Be(t,["yahooStockSymbol"]);e.quoteResponse.result.forEach(r=>Object.assign(n.get(r.symbol)?.[0],r))}async init(){await this.refreshQuotes(),await this.getAccountList()}async getAccountList(){if(this.orderType()===T.SellQuantity)return;let t=(await this.wealthSimpleService.getAccountList()).results.find(n=>n.id===this.accountId());this.buyingPower.set(t?.buying_power?.amount||0)}async deleteConfirm(e){window.confirm("Deleting Order")&&await this.deleteOrder(e)}async deleteOrder(e){await this.wealthSimpleService.deleteOrder(e.order_id),console.log("Deleted successfully"),this.dismissModal()}async getYahooQuotes(e){try{let t=this.positions();if(!t?.length)return;let n=t.map(p=>p.yahooStockSymbol),r=await this.wealthSimpleService.getYahooQuotes(n);this.mapPositions(r)}catch(t){console.error("Error fetching Yahoo quotes:",t)}finally{e?.target?.complete()}}async refreshQuotes(e){this.startPolling(),e&&e.target.complete()}async createQuote(){let e=this.orderType();if(!e)return;let t=this.data(),n=e===T.BuyQuantity,r=n?p=>p.price>=p.position.regularMarketPrice:p=>p.price<=p.position.regularMarketPrice;t.some(r)&&!window.confirm(n?"Buying price >= current price":"Selling price <= current price")||await this.confirmOrder()}async confirmOrder(){let e=this.data(),t=this.global(),n=this.accountId(),r=this.orderType();if(n){for(let p of e){let g=await this.wealthSimpleService.createQuote(p,t.untilCancelled,n,String(r)),W=g.error||`Created ${g.quantity}*${g.limit_price.amount} = ${g.quantity*g.limit_price.amount}`;console.log(W),await new Promise(ie=>setTimeout(ie,1e3))}this.dismissModal()}}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=V({type:i,selectors:[["wealth-simple-create-quote-modal"]],inputs:{accountId:[1,"accountId"],orderType:[1,"orderType"],positions:[1,"positions"],untilCancelled:[1,"untilCancelled"]},outputs:{untilCancelled:"untilCancelledChange"},features:[pe([D])],decls:55,vars:23,consts:[[1,"fs-11"],["slot","end"],[3,"ngModelChange","ngModel"],["fill","clear",3,"click"],["name","refresh-outline"],["slot","icon-only","name","close"],["scrollbarThemeDirective",""],["slot","fixed",3,"ionRefresh"],[1,"ion-cols"],["label","Amount","labelPlacement","stacked","type","number","placeholder","Amount",3,"ngModelChange","ngModel"],["label","Quantity","labelPlacement","stacked","type","number","placeholder","Quantity",3,"ngModelChange","ngModel"],["label","Percentage","labelPlacement","stacked","type","number","placeholder","Price",3,"ngModelChange","ngModel"],["label","Price Type","labelPlacement","stacked",3,"ngModelChange","ngModel"],[3,"value"],[1,"align-items-center","display-flex","justify-content-space-between","width-100-pc"],[1,"display-flex"],["expand","full","color","medium",1,"font-10"],["expand","full",3,"click"],["expand","full","color","medium",1,"font-10",3,"click"],[1,"display-flex","justify-content-space-between","width-100-pc"],["target","_blank",3,"href"],["label","Price","labelPlacement","stacked","type","number","placeholder","Price",3,"ngModelChange","ngModel"],[1,"m-r-10","time-in-force",3,"ngClass"],[3,"click"],["name","close-outline"],["name","arrow-forward-outline"],["color","danger","name","close-circle",1,"fs-13",3,"click"],["size","2",1,"ion-cols","field-header"],["size","4",1,"ion-cols","field-value"],["name","copy-outline",3,"click"],[1,"percent-font"]],template:function(t,n){t&1&&(l(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),d(3," Create Quote "),l(4,"small",0),d(5),a()(),l(6,"ion-buttons",1)(7,"ion-item")(8,"ion-toggle",2),se("ngModelChange",function(p){return ce(n.untilCancelled,p)||(n.untilCancelled=p),p}),d(9,"Until Cancelled"),a()(),l(10,"ion-button",3),u("click",function(){return n.getYahooQuotes(null)}),x(11,"ion-icon",4),a(),l(12,"ion-button",3),u("click",function(){return n.dismissModal()}),x(13,"ion-icon",5),a()()()(),l(14,"ion-content",6)(15,"ion-refresher",7),u("ionRefresh",function(p){return n.refreshQuotes(p)}),x(16,"ion-refresher-content"),a(),l(17,"ion-list")(18,"ion-item-group")(19,"ion-row")(20,"ion-col",8)(21,"ion-item")(22,"ion-input",9),u("ngModelChange",function(p){return n.updateAmount(p)}),a()()(),l(23,"ion-col")(24,"ion-item")(25,"ion-input",10),u("ngModelChange",function(p){return n.updateQuantity(p)}),a()()(),l(26,"ion-col")(27,"ion-item")(28,"ion-input",11),u("ngModelChange",function(p){return n.updatePricePercentage(p)}),a()()(),l(29,"ion-col")(30,"ion-item")(31,"ion-select",12),u("ngModelChange",function(p){return n.updatePriceType(p)}),k(32,St,2,2,"ion-select-option",13,A),a()()()()(),l(34,"ion-item-group")(35,"ion-item-divider")(36,"div",14)(37,"span",15),k(38,xt,2,2,"ion-button",16,A),k(40,ft,2,1,"ion-button",16,A),a(),l(42,"span"),d(43),b(44,"number"),b(45,"number"),b(46,"number"),a()()(),k(47,Ft,22,14,null,null,K),a()()(),l(49,"ion-footer")(50,"ion-toolbar")(51,"ion-button",17),u("click",function(){return n.createQuote()}),d(52,"Create Quotes "),l(53,"small",0),d(54),a()()()()),t&2&&(o(5),v("(",n.orderType(),")"),o(3),re("ngModel",n.untilCancelled),o(14),y("ngModel",n.amount()),o(3),y("ngModel",n.quantity()),o(3),y("ngModel",n.pricePercentage()),o(3),y("ngModel",n.priceType()),o(),F(n.summaryList),o(6),F(ue(19,ht,-1,-7)),o(2),F(Y(22,Ct)),o(3),U("",P(44,10,n.buyingPower(),"1.0-2")," - ",P(45,13,n.total(),"1.0-2")," = ",P(46,16,n.buyingPower()-n.total(),"1.0-2")),o(4),F(n.data()),o(7),v("(",n.orderType(),")"))},dependencies:[X,J,Z,Ne,L,N,H,Q,z,tt,q,j,R,fe,ye,xe,Ge,te,ee,ve,He,he,be,Me,me],styles:[".ion-cols[_ngcontent-%COMP%]{margin:0;padding:0}.percent-font[_ngcontent-%COMP%]{font-size:11px}.field-header[_ngcontent-%COMP%], .field-value[_ngcontent-%COMP%]{font-size:12px;padding:5px}.time-in-force[_ngcontent-%COMP%]{border-left:3px solid transparent;padding-left:5px}.time-in-force.day[_ngcontent-%COMP%]{border-left-color:var(--ion-color-danger)!important}.time-in-force.until_cancel[_ngcontent-%COMP%]{border-left-color:var(--ion-color-primary)!important}"],changeDetection:0})}return We([qe({message:"Deleting Order"})],i.prototype,"deleteOrder",null),i})(),Fi=(()=>{class i{modalController=E(G);wealthSimpleService=O(D);email=S("");password=S("");otp=S("");user=w(()=>({email:this.email(),password:this.password(),otp:this.otp()}));isFormValid=w(()=>!!(this.email()&&this.password()&&this.otp()));dismissModal(e){this.modalController.dismiss(e)}async login(){if(this.isFormValid()){let e=this.user(),t=await this.wealthSimpleService.loginUser(e);this.dismissModal({accessToken:t})}}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=V({type:i,selectors:[["wealth-simple-login-modal"]],decls:21,vars:4,consts:[["slot","end"],["fill","clear",3,"click"],["slot","icon-only","name","close"],["color","primary",1,"ion-justify-content-center"],["size-md","6","size-lg","5","size-xs","12",1,"ion-align-self-center"],["name","email","type","text","placeholder","username","required","",3,"ionInput","value"],["name","password","type","password","placeholder","Password","required","",3,"ionInput","value"],["name","otp","type","text","clearInput","","placeholder","otp","required","",3,"ionInput","value"],["size","large","type","button","expand","block",3,"click","disabled"]],template:function(t,n){t&1&&(l(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),d(3,"Login"),a(),l(4,"ion-buttons",0)(5,"ion-button",1),u("click",function(){return n.dismissModal()}),x(6,"ion-icon",2),a()()()(),l(7,"ion-content")(8,"ion-grid")(9,"ion-row",3)(10,"ion-col",4)(11,"div")(12,"ion-item")(13,"ion-input",5),u("ionInput",function(p){return n.email.set(p.detail.value||"")}),a()(),l(14,"ion-item")(15,"ion-input",6),u("ionInput",function(p){return n.password.set(p.detail.value||"")}),a()(),l(16,"ion-item")(17,"ion-input",7),u("ionInput",function(p){return n.otp.set(p.detail.value||"")}),a()()(),l(18,"div")(19,"ion-button",8),u("click",function(){return n.login()}),d(20," Login "),a()()()()()()),t&2&&(o(13),y("value",n.email()),o(2),y("value",n.password()),o(2),y("value",n.otp()),o(2),y("disabled",!n.isFormValid()))},dependencies:[L,N,H,Q,q,j,R,Ce,te,ee,z,be],styles:["ion-item[_ngcontent-%COMP%]{--background: #3880ff;--color: #fff}ion-button[_ngcontent-%COMP%]{--background: #062f77}"],changeDetection:0})}return i})(),Wi=(()=>{class i{modalController=E(G);wealthSimpleService=O(D);accountIds=B([]);scheduledActivities=S([]);sortField=S("assetSymbol");sortDirection=S("desc");searchTerm=S("");searchableFields=S("assetSymbol,accountId,amount,frequency");selectedSearchField=S("all");isGrouped=S(!1);groupByField=S("");groupedActivities=S(new Map);sortFieldValue=w(()=>this.sortField());sortDirectionValue=w(()=>this.sortDirection());searchTermValue=w(()=>this.searchTerm());searchableFieldsValue=w(()=>this.searchableFields());selectedSearchFieldValue=w(()=>this.selectedSearchField());isGroupedValue=w(()=>this.isGrouped());groupByFieldValue=w(()=>this.groupByField());groupedActivitiesValue=w(()=>this.groupedActivities());scheduledActivitiesValue=w(()=>this.scheduledActivities());filteredActivities=w(()=>{let e=this.scheduledActivities(),t=this.searchTerm().trim();return t?e.filter(n=>{if(this.selectedSearchField()===this.searchableFields())return this.searchableFields().split(",").some(r=>{let p=n[r];return p&&p.toString().toLowerCase().includes(t.toLowerCase())});{let r=n[this.selectedSearchField()];return r&&r.toString().toLowerCase().includes(t.toLowerCase())}}):e});sortedActivities=w(()=>{let e=[...this.filteredActivities()],t=this.sortField(),n=this.sortDirection();return e.sort((r,p)=>{let g,W;return t==="amount"?(g=r.amount?parseFloat(r.amount):0,r.amountSign==="negative"&&(g*=-1),W=p.amount?parseFloat(p.amount):0,p.amountSign==="negative"&&(W*=-1)):(g=r[t]||"",W=p[t]||""),n==="asc"?g>W?1:g<W?-1:0:g<W?1:g>W?-1:0})});groupedData=w(()=>{if(!this.isGrouped()||!this.groupByField())return new Map;let e=this.sortedActivities(),t=new Map;return e.forEach(n=>{let p=(n[this.groupByField()]||"Unknown").toString();t.has(p)||t.set(p,[]),t.get(p).push(n)}),t});groupKeys=w(()=>{let e=this.sortDirection();return Array.from(this.groupedData().keys()).sort((t,n)=>e==="asc"?t.localeCompare(n):n.localeCompare(t))});constructor(){we({close:Te,arrowUp:lt,arrowDown:nt,search:ut,analytics:it}),$(()=>{this.accountIds()?.length&&this.loadScheduledActivities()})}async loadScheduledActivities(){let e=this.accountIds();if(e?.length)try{let t=await this.wealthSimpleService.getScheduledActivities(e);this.scheduledActivities.set(t)}catch(t){console.error("Error loading scheduled activities",t)}}dismiss(){this.modalController.dismiss()}getFormattedAmount(e){if(!e.amount)return"";let t=e.amountSign==="negative"?"-":"",n=e.currency||"";return`${t}${n} ${e.amount}`}calculateTotalAmount(e){if(!e||e.length===0)return"0";let t=0,n="";return e.forEach(r=>{if(r.amount){let p=parseFloat(r.amount)||0;t+=r.amountSign==="negative"?-p:p,!n&&r.currency&&(n=r.currency)}}),`${t<0?"-":""}${n} ${Math.abs(t).toFixed(2)}`}sort(e){this.sortField()===e?this.sortDirection.set(this.sortDirection()==="asc"?"desc":"asc"):(this.sortField.set(e),this.sortDirection.set("asc"))}getSortIcon(e){return this.sortField()!==e?"":this.sortDirection()==="asc"?"arrow-up":"arrow-down"}setSearchField(e){e==="all"?(this.selectedSearchField.set(this.searchableFields()),this.isGrouped.set(!1)):this.selectedSearchField.set(e)}toggleGroupByField(e){if(e==="all"){this.isGrouped.set(!1),this.groupByField.set("");return}this.groupByField()===e&&this.isGrouped()?(this.isGrouped.set(!1),this.groupByField.set("")):(this.isGrouped.set(!0),this.groupByField.set(e))}isFieldSelected(e){return e==="all"?this.selectedSearchField()===this.searchableFields():this.selectedSearchField()===e}updateSearchTerm(e){this.searchTerm.set(e)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=V({type:i,selectors:[["wealth-simple-scheduled-activities-modal"]],inputs:{accountIds:[1,"accountIds"]},decls:10,vars:1,consts:[["slot","end"],[3,"click"],["slot","icon-only","name","close"],[1,"ion-padding"],["lines","none"],["placeholder","Search activities...","animated","",3,"ngModelChange","ngModel"],[1,"ion-text-bold"],[1,"search-field-options"],[3,"active"],[3,"click","dblclick"],["name","analytics"],["lines","none","color","light"],[1,"ion-no-padding"],[1,"ion-align-items-center","ion-text-bold"],["size","3",1,"sortable-column",3,"click"],["size","small",3,"name"],["size","3"],["lines","none",1,"ion-text-end"],["color","dark"],[1,"ion-text-center"],["name","crescent",1,"ion-margin-auto"]],template:function(t,n){t&1&&(l(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),d(3," Scheduled Activities "),a(),l(4,"ion-buttons",0)(5,"ion-button",1),u("click",function(){return n.dismiss()}),x(6,"ion-icon",2),a()()()(),l(7,"ion-content",3),m(8,Yt,3,1,"div")(9,Jt,4,0),a()),t&2&&(o(8),_(n.scheduledActivitiesValue().length?8:9))},dependencies:[X,J,Z,L,N,Q,q,j,H,R,_e,ge,Ue,Ce,te,ee,Pe,Ye,z,Se,ze,xe,Re,Le,Ke],styles:[".sortable-column[_ngcontent-%COMP%]{cursor:pointer;-webkit-user-select:none;user-select:none;display:flex;align-items:center;gap:4px}.sortable-column[_ngcontent-%COMP%]:hover{background-color:#0000000d}ion-icon[size=small][_ngcontent-%COMP%]{font-size:14px}.search-field-options[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px}.search-field-options[_ngcontent-%COMP%]   ion-chip[_ngcontent-%COMP%]{--background: transparent;--color: var(--ion-color-medium)}.search-field-options[_ngcontent-%COMP%]   ion-chip.active[_ngcontent-%COMP%]{--background: var(--ion-color-primary);--color: white}"],changeDetection:0})}return i})(),ke=class{wealthSimpleServiceLocal=O(D)};var Ie=(()=>{class i extends ke{modalController=E(G);alertController=E(Ze);wealthSimpleService=O(D);actionSheetController=E(Je);loggedIn=S(!1);sortField=S("");searchBy=S("");reverse=S(!1);multiSelectMode=S(!1);positions=S([]);activities=S([]);selectedIndex=S(0);summary=S({});percent=S(.8);accounts=S([]);selectedAccount=S({});headers=[{prop:"stockSymbol",title:"Sym.",templatedId:"stockSymbol",disabled:!1},{prop:"quantity",title:"Qty.",width:"30px"},{prop:"averagePrice",title:"Avg.",subTitle:"Per Share",bold:!0,percent:!0},{prop:"regularMarketPrice",title:"Curr. Value",subTitle:"Per Share",bold:!0},{prop:"regularMarketDayLow",title:"Day Low",subTitle:"Per Share",bold:!0,percent:!0},{prop:"regularMarketDayHigh",title:"Day High",subTitle:"Per Share",bold:!0,percent:!0},{prop:"fiftyTwoWeekLow",title:"52W Low",subTitle:"Per Share",bold:!0,percent:!0},{prop:"fiftyTwoWeekHigh",title:"52W High",subTitle:"Per Share",bold:!0,percent:!0},{prop:"returnPercent",title:"Return",subTitle:"percent",bold:!0,highlightCell:!0},{prop:"regularMarketChangePercent",title:"Day Return",subTitle:"percent",bold:!0,numberPipe:!0,highlightCell:!0,medianNumber:0},{prop:"dayReturnOnAvgPercent",title:"Day Return Avg",subTitle:"percent",bold:!0,numberPipe:!0,highlightCell:!0,medianNumber:0},{prop:"yesterdaysReturnPercent",title:"Yesterdays Return Avg",subTitle:"percent",bold:!0,numberPipe:!0,highlightCell:!0,medianNumber:0},{prop:"totalDifference",title:"Return",subTitle:"All Shares",highlightCell:!0},{prop:"todaysReturnAllShares",title:"Day Return",subTitle:"All Shares",highlightCell:!0},{prop:"totalPurchased",title:"Purchased",subTitle:"All Shares"},{prop:"totalPurchasedCurrent",title:"Curr. Value",subTitle:"All Shares"},{prop:"holdingPerct",title:"Holding %",subTitle:"percent"},{prop:"dayRangePos",title:"Day POS",subTitle:"percent",bold:!0,highlightCell:!0,medianNumber:20},{prop:"fiftyTwoWeekRangePos",title:"52W POS",subTitle:"percent",bold:!0,highlightCell:!0,medianNumber:20},{prop:"fiftyDayAverageChangePercent",title:"50D",subTitle:"percent",numberPipe:!0,highlightCell:!0,mul:100},{prop:"twoHundredDayAverageChangePercent",title:"200D",subTitle:"percent",numberPipe:!0,highlightCell:!0,mul:100},{prop:"difference",title:"Return",subTitle:"Per Share",highlightCell:!0},{prop:"regularMarketChange",title:"Day Return",subTitle:"Per Share",numberPipe:!0},{prop:"currentPriceWS",title:"WS Curr",subTitle:"Per Share",bold:!0},{prop:"totalDifferenceWS",title:"Return WS",subTitle:"All Shares"},{prop:"differenceWS",title:"Return WS",subTitle:"Per Share",bold:!0},{prop:"totalPurchasedCurrentWS",title:"Curr. Value",subTitle:"WS All Shares"},{prop:"currMinDiff",title:"Curr-Min",subTitle:"Per Share"},{prop:"currMaxDiff",title:"Max-Curr",subTitle:"Per Share"},{prop:"currMaxDiffPerct",title:"Max-Curr",subTitle:"percent"},{prop:"minMaxPerct",title:"Min-Max",subTitle:"percent"},{prop:"maxAvgPerct",title:"Max-Avg",subTitle:"percent"},{prop:"avgMinPerct",title:"Avg-Min",subTitle:"percent",bold:!0},{prop:"return15",title:"Qty for 15%",bold:!0},{prop:"stockPrimaryExchange",title:"Exchange"},{prop:"currency",title:"Currency"},{prop:"dayRangePos",title:"Day Range",templatedId:"dayRange"},{prop:"fiftyTwoWeekRangePos",title:"52W Range",templatedId:"52WRange"},{prop:"stockName",title:"Name",templatedId:"stockName"}];filteredPositions=w(()=>{let e=this.positions(),t=this.searchBy();if(!t.trim())return e;let n=t.toLowerCase();return e.filter(r=>r.stockSymbol?.toLowerCase().includes(n)||r.stockName?.toLowerCase().includes(n))});summaryDisplay=w(()=>{let e=this.summary();return e.total?{totalValue:e.total,totalWS:e.totalWS,changeAmount:e.loss+e.gain,changeAmountWS:e.lossWS+e.gainWS,changePercent:(e.loss+e.gain)/e.totalPurchased*100,changePercentWS:(e.lossWS+e.gainWS)/e.totalPurchased*100,todaysReturn:e.todaysReturnAllShares,todaysReturnWS:e.todaysReturnAllSharesWS,todaysReturnPercent:e.todaysReturnAllShares/e.totalPurchased*100,todaysReturnPercentWS:e.todaysReturnAllSharesWS/e.totalPurchased*100}:null});pollingId=null;constructor(){super(),we({close:Te,checkmark:ct,refresh:pt,menu:dt,checkmarkDoneCircle:st,calendar:rt,arrowDownOutline:ot,arrowUpOutline:at}),$(()=>{let e=this.loggedIn(),t=this.selectedAccount();e&&t?.id&&!this.pollingId?this.startPolling():!e&&this.pollingId&&this.stopPolling()}),this.initializeComponent()}ngOnDestroy(){this.stopPolling()}async initializeComponent(){let e=await this.wealthSimpleService.checkLogin();this.loggedIn.set(e),await this.initializeAndStartPolling()}startPolling(){this.pollingId||(this.pollingId=setInterval(async()=>{let e=this.selectedAccount();if(!e?.id)return;let{positions:t,summary:n}=await this.wealthSimpleService.fetchPortfolio(e.id),r=this.headers.find(g=>g.prop===this.sortField())??null,p=this.wealthSimpleService.sortPositions(t,r,this.reverse());this.positions.set(p),this.summary.set(n)},5e3))}stopPolling(){this.pollingId&&(clearInterval(this.pollingId),this.pollingId=null)}async login(){await this.openLoginForm(),await this.initializeAndStartPolling()}async logout(){await this.wealthSimpleService.logout(),this.stopPolling(),await this.initializeAndStartPolling()}async initializeAndStartPolling(){let e=await this.wealthSimpleService.initialize();this.loggedIn.set(e.loggedIn),this.accounts.set(e.accounts),this.selectedAccount.set(e.selectedAccount),e.loggedIn&&e.selectedAccount?.id&&await this.refreshPositions()}getPositions(e){return this.refreshPositions(e)}async refreshPositions(e){let t=this.selectedAccount();if(this.wealthSimpleService.storeSelectedAccount(t),!this.loggedIn()){e?.target?.complete();return}try{let{positions:n,summary:r}=await this.wealthSimpleService.fetchPortfolio(t.id);this.positions.set(n),this.summary.set(r)}catch(n){console.error(n)}finally{e?.target?.complete()}}toggleMultiSelect(e){let t=this.positions();this.wealthSimpleService.setChecked(t,!1),this.multiSelectMode.set(e)}setChecked(e){let t=this.positions();this.wealthSimpleService.setChecked(t,e)}selectAll(){let e=this.positions();this.wealthSimpleService.toggleSelectAll(e)}sort(e,t){this.sortField.set(e.prop);let n=t??this.reverse();this.reverse.set(n);let r=this.positions(),p=this.wealthSimpleService.sortPositions(r,e,n);this.positions.set(p)}async openLoginForm(){let e=await this.modalController.create({component:Fi,cssClass:"my-custom-class",id:"Login"});await e.present();let{data:t}=await e.onWillDismiss();return t?.accessToken}async openAdditionOperationsAlert(e){let t=this.positions(),n=e?[e]:t.filter(g=>g.selected);if(this.multiSelectMode()&&e)return;let r=Object.values(T).map(g=>({text:g,handler:()=>{[T.BuyQuantity,T.SellQuantity].includes(g)&&this.openCreateQuote(n,g)}}));await(await this.actionSheetController.create({header:`Additional Operations (${n.map(g=>g.stockSymbol).join(",")})`,cssClass:"action-sheet-css",buttons:r})).present()}async openCreateQuote(e,t){let n=[...new Set(e.map(g=>g.currency))],r=[],p=this.selectedAccount();n.filter(g=>g!=="CAD").length>0&&r.push(`${n.join(",")} selected`),p.account_type==="ca_tfsa"&&r.push("TFSA selected"),r.length>0?await(await this.alertController.create({header:"Confirm",message:r.join(", "),buttons:[{text:"Cancel",role:"cancel"},{text:"Continue",handler:async()=>await this.createQuoteModal(e,t)}]})).present():await this.createQuoteModal(e,t)}async createQuoteModal(e,t){let n=this.selectedAccount(),r=await this.modalController.create({component:ki,componentProps:{positions:JSON.parse(JSON.stringify(e)),accountId:n?.id,orderType:t}});await r.present();let{data:p}=await r.onWillDismiss()}async openScheduledActivitiesModal(){let e=this.loggedIn(),t=this.selectedAccount(),n=this.accounts();if(!e||!t)return;await(await this.modalController.create({component:Wi,componentProps:{accountIds:n.map(p=>p.id)}})).present()}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=V({type:i,selectors:[["wealth-simple-component"]],features:[pe([D]),Ae],decls:5,vars:4,consts:[[1,"fs-11","summary","display-flex","justify-content-space-around"],[3,"multiselectmode"],[1,"display-flex","align-items-center"],[1,"display-flex","flex-direction-column"],[1,"border-b-ionic"],["expand","full",3,"click"],["slot","fixed",3,"ionRefresh"],[1,"display-flex","justify-content-space-around"],["autocorrect","on","animated","",3,"ngModelChange","ngModel"],["label","Account Type","labelPlacement","stacked",3,"ngModelChange","ngModel"],[3,"value"],[1,"table-styles"],[1,"table-header",3,"minWidth"],[1,"table-row",3,"selected"],[1,"table-header",3,"click"],[1,"header-title"],[1,"sort-icon"],[3,"name"],[1,"sub-head"],[1,"table-row",3,"click"],[3,"bold"],["rowspan","2"],[1,"fs-8",3,"lossStyles","gainStyles"],[1,"fs-8"],[1,"first-col"],[1,"ellipsis"],[1,"first-col",3,"click"],[3,"ngModel"],[3,"ngModelChange","ngModel"],["disabled","true","mode","ios",3,"min","max","value"],["slot","start",2,"width","60px","text-align","right"],["slot","end",2,"width","60px"],["snaps","true","disabled","true","mode","ios",3,"step","min","max","value"],["target","_blank",3,"href"],["fill","clear"],["fill","clear",3,"click"],["slot","icon-only","name","log-out"],[3,"click"],["name","calendar"],["slot","icon-only","name","refresh"],["slot","icon-only","name","menu"],["slot","icon-only","name","close"],["slot","icon-only","name","checkmark-done-circle"],["slot","icon-only","name","checkmark"]],template:function(t,n){if(t&1&&(m(0,ei,44,72,"span",0),l(1,"ion-card"),m(2,ti,4,0,"ion-card-content"),m(3,vi,17,4,"ion-card-content",1),a(),m(4,wi,10,3,"ion-footer")),t&2){let r;_((r=n.summaryDisplay())?0:-1,r),o(2),_(n.loggedIn()?-1:2),o(),_(n.loggedIn()?3:-1),o(),_(n.loggedIn()?4:-1)}},dependencies:[X,J,Z,_e,ge,N,q,fe,ye,Pe,Se,Me,Xe,ve,et,he,Q,j,z,me],styles:["ion-col[_ngcontent-%COMP%]{width:100px}ion-row[_ngcontent-%COMP%]{width:1500px}.ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.sub-head[_ngcontent-%COMP%]{font-size:7px}.sort-icon[_ngcontent-%COMP%]{position:absolute;font-size:8px;display:inline-block;top:0;left:-8px}.table-styles[_ngcontent-%COMP%]{font-size:12px;overflow-x:auto;display:block;height:calc(100vh - 220px)}.table-styles[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%], .table-styles[_ngcontent-%COMP%]   .first-col[_ngcontent-%COMP%]{position:sticky;z-index:3;background:var(--background);background-color:var(--ion-background-color-step-100)}.table-styles[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]{top:0;min-width:80px;text-align:left}.table-styles[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]:first-child{left:0;z-index:4;min-width:50px;text-align:center}.multiselectmode[_ngcontent-%COMP%]   .table-styles[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]:first-child{min-width:80px}.table-styles[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]{height:70px;border-bottom:1px solid var(--ion-item-border-color, var(--ion-border-color, var(--ion-background-color-step-150, rgba(0, 0, 0, .13))))}.table-styles[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding-left:4px}.table-styles[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:7px}.table-styles[_ngcontent-%COMP%]   .table-row.selected[_ngcontent-%COMP%], .table-styles[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]:hover{background-color:var(--ion-background-color-step-100)}.table-styles[_ngcontent-%COMP%]   .first-col[_ngcontent-%COMP%]{left:0;text-align:center}.multiselectmode[_ngcontent-%COMP%]   .table-styles[_ngcontent-%COMP%]   .first-col[_ngcontent-%COMP%]{text-align:unset}.bold[_ngcontent-%COMP%]{color:#fff}ion-refresher.refresher-native[_ngcontent-%COMP%]{z-index:5}ion-checkbox[_ngcontent-%COMP%]{--size: 12px}ion-range[_ngcontent-%COMP%]{width:300px;--knob-size: 10px}.summary[_ngcontent-%COMP%]{color:var(--ion-text-color-step-550)}.summary[_ngcontent-%COMP%]   .flex-direction-column[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding-top:2px;padding-bottom:2px;margin-left:2px;margin-right:2px}.gainStyles[_ngcontent-%COMP%]{color:#81c995}.lossStyles[_ngcontent-%COMP%]{color:#f28b82}.percent-val[_ngcontent-%COMP%]{position:relative;top:-13px;right:3px;font-size:8px}"],changeDetection:0})}return i})(),zi=(()=>{class i{wealthSimpleComponent=Oe(Ie);ngOnInit(){}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=V({type:i,selectors:[["wealth-simple"]],viewQuery:function(t,n){t&1&&De(n.wealthSimpleComponent,Ie,5),t&2&&Ee()},decls:8,vars:0,consts:[["slot","start"],["scrollbarThemeDirective",""]],template:function(t,n){t&1&&(l(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),x(3,"ion-menu-button"),a(),l(4,"ion-title"),d(5,"WealthSimple"),a()()(),l(6,"ion-content",1),x(7,"wealth-simple-component"),a())},dependencies:[Ie,L,N,Q,je,H,R],encapsulation:2})}return i})();export{zi as WealthSimplePage};
